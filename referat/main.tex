%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                             %
% Anwendungsbeispiel für das Beamer-Template TU Chemnitz                      %
% (c) Mario Haustein (mario.haustein@hrz.tu-chemnitz.de), 2013-2014           %
%                                                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage[utf8]{inputenc}
\usepackage{babel}
\usepackage{floatflt}
\usepackage{float}
\usepackage{graphics}
\usepackage{listings}
\usepackage{color}

% TUC-Templates laden.
\usetheme[fakcolor=if]{tuc2014}
\mode<article>{\usepackage{beamerarticletuc2014}}

%
% Weitere Anpassungen nach Bedarf.
%

% Metadaten
\title{OpenTuner: An Extensible Framework \\ for Program Autotuning}
\subtitle{Hauptseminar WS 2016/2017}
\author{Matthias Tietz}

\date{10.02.2017}
\institute[TUC]

\begin{document}

    \tucthreeheadlines
    
    \begin{frame}
      \titlepage
    \end{frame}

    \begin{frame}

       \frametitle{Gliederung}
       \tableofcontents

    \end{frame}


    \tuctwoheadlines

    %
    % Inhalt
    %
    
%%%%% section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    \section{Einleitung}

%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   

    \begin{frame}
    \textbf{1. Einleitung}
        
    \begin{itemize}
      % findet Anwendung in Domänen wie HPC und Grafikverarbeitung (PS, 3D, image processing)
      % (hoher Rechenaufwand) -> Zeitgewinn ... hand-optimierte AT ..
      \item Suche nach optimaler Programm-Implementierung teil-/vollautomatisierbar
            
      \item bestehende Autotuning-Frameworks meist domänenspezifisch (ATLAS, FFTW) \newline
      % lineare Algebra, FFT
      % referenz / link auf ATLAS, FFTW

    \end{itemize}
      \text{OpenTuner:}
    \begin{itemize}
      \item Ausdrücken des Suchraums statt direkter Optimierung
      \item Verfahren komfortabler und oft effizienter (große Suchräume)
      % Suchraum = Parameter, mögliche Implementierungen
      % per Hand schwer machbar bzw. sehr ineffizient
      
      \item mehrere Optimierungsziele komibinierbar
      % Tradeoff Performance - Genauigkeit
            
      \item stark auf Erweiterbarkeit ausgelegt
      
    \end{itemize}
      
%   \hspace{0.33cm}    
%   \includegraphics[width=4cm]{bilder/3dpolyp}
%   \hspace{0.33cm}    
%   \fbox{\parbox[b][5em][c]{0.55\textwidth}{\textbf{Ziele:}
%       Automatisierter und einfacher Optimierungsprozess.
%       Bessere und portierbare Performance von domänenspezifischen Programmen.}}
% 
    \end{frame}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
    
  \begin{frame}
    \textbf{gebräuchliche Begriffe:}
    
  \begin{itemize}

    \item \textbf{Parameter}: Variablen eines bestimmten Typs 
    % Modellierung
    % Programm XY -> welche Parameter sollen modelliert werden? spätere Folie dazu mehr
    
    \item \textbf{Konfiguration}: konkrete Zuweisungen von Parametern
    \item \textbf{Konfigurations-Manipulator}: Bearbeiten der Parametern in Konfig. \newline
    % Funktion
    
    \item \textbf{Suchraum}: zu durchsuchende Menge von Konfigurationen
    % mögliche Implementierungen
    
    \item \textbf{Suchtechnik}: Suchraum erforschen (KM), Anfragen für Messung (Ergebnis)
    % folie mit grafik schön zu sehen
     
    \item \textbf{Suchprozess}: Lesen/Schreiben von Konfigurationen \newline
    \item \textbf{Messprozess}: konkrete Konfiguration ausführen
    \item \textbf{Messresultat}: Ergebnis der Messung, abhängig von Optimierungsziel(en)
    \item \textbf{Ergebnisdatenbank}: Festhalten aller Ergebnisse während Tuning-Vorgangs
    
  \end{itemize}
  \end{frame}
        
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
      
    \begin{frame}
    
    \textbf{Die Herausforderungen bei der Entwicklung eins Autotuning-Frameworks:}
    
    \begin{itemize}
       
    \item 1. Eine passende Konfigurations-Repräsentation
        \begin{itemize}
          \item Darstellung der domänenspezif. Datenstrukturen und Bedingungen
          \item Qualität der Repräsentation entscheidend für Effizienz des Autotuners \newline
        \end{itemize}
        
    \item 2. Größe des gültigen Konfigurations-Raumes
        \begin{itemize}
          \item Kürzen des Konfigurations-Raumes $\rightarrow$ Verlieren guter Lösungen
          (bei bisherigen Autotunern gängige Praxis, da vollständige Suche)
          \item rießige Konfigurationsräume möglich $\rightarrow$  intelligente Suchtechniken notwendig \newline
        \end{itemize}
        
    \item 3. Beschaffenheit des Konfigurations-Raumes
      \begin{itemize}
        \item Suchräume in der Praxis meist sehr komplex 
        \item domänenspezif. Suchtechniken notwendig um optimale Lösung effizient zu ermitteln
      \end{itemize}
    \end{itemize}
        
    \end{frame}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   

%     \begin{frame}
%     
%     \textbf{Eigenschaften von OpenTuner:}   
%     \begin{itemize}
%       \item Erstellen domänenspezifischer und multi-objective Programm-Autotuner
%       \item vollständig anpassbare Konfigurations-Repräsentation
%       \item erweiterbare Repräsentation für Suchtechniken und Datentypen
%       \item Kombination mehrerer Suchtechniken (\textit{Ensembles}), dynamische Zuweisung der
%       Testanteile für die jeweiligen Suchtechniken
%       \item einfache Schnittstelle zur Kommunikation mit dem zu optimierenden Programm           
%     \end{itemize}
%     \end{frame}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
%%%%% section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \section{OpenTuner Framework}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  



%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
  
  \begin{frame}
  
  \textbf{2. OpenTuner Framework}
  \begin{itemize}
    \item Autotuning-Problem $\rightarrow$ Suchproblem
    \item Suchraum: Menge der Konfigurationen (Belegung von Parametern)
    \item Messung: 1 konkrete Konfig. wird gemessen: Ausführung $\rightarrow$ Ergebnis
    \item Möglichkeit mehrere Messungen parallel auszuführen
    
    \begin{figure}[ht]
      \centering	      
      \includegraphics[scale=0.75]{bilder/smdb}
      \label{smdb}
    \end{figure}

  \end{itemize}
  \end{frame}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  \subsection{Verwendung}

  \begin{frame}
  \textbf{Verwendung}
  \begin{itemize}
    \item 1. Suchraum definieren (Konfig.-Manipulator)
    \item 2. \texttt{run()}-Methode definieren: Auswerten der Konfig. im Suchraum $\rightarrow$ Ergebnis
    \item 3. Festlegen des Optimierungsziels
    \item Umsetzung mittels kleinem Python-Programm (OpenTuner API), Framework ist ausschließlich in 
    Python geschrieben
  \end{itemize}
  \textbf{Suchtechniken}
  \begin{itemize}
    \item OpenTuner stellt Suchtechniken für viele Suchraum-Typen bereit
    \item Ausführen mehrerer Suchtechniken gleichzeitig (Ensembles)
    \item dynamische Testzuweisung anhand Erfolges dieser Techniken
%     \item erweiterbar: benutzerdefinierte Suchtechniken
  \end{itemize}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%  \subsection{Konfigurations-Manipulator}

  \begin{frame}
  \textbf{Konfigurations-Manipulator}
  \begin{itemize}
    \item Abstraktionsschicht zwischen Suchtechnik und roher Konfigurations-Struktur
    \item Liste der Parameter/Datenstruktur ist dynamisch erweiterbar
  \end{itemize}
  \textbf{Parameter-Typen}
  \begin{itemize}
    \item jeder Parametertyp ist verantwortlich für Schnittstelle zwischen roher 
    Parameterrepräsentation und stand. Ansicht dieses Parameters für die Suchtechnik
    \item Parameterrepräsentation und Abstraktion erweiterbar/konfigurierbar
  \end{itemize}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
    \begin{figure}[ht]
      \centering	      
      \includegraphics[scale=1.1]{bilder/paramtypes}
      \label{paramtypes}
    \end{figure}
    
  \textbf{Primitive Parameter}
  \begin{itemize}
    \item numerische Werte mit Unter-/Obergrenze
    \item \texttt{Float} und \texttt{LogFloat (-Int)} gleiche Repräsentation in der Konfiguration, aber 
    untersch. Ansicht des zugrundeliegenden Wertes für die Suchtechnik (skaliert)
    \item Grund: ohne Logskal. würde Effekt der Wertänderung mit steigender Parametergröße sinken
  \end{itemize}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
    \textbf{Komplexe Parameter}
    \begin{itemize}
      \item haben variables Set an Manipulatoren $\rightarrow$ stochastische Parameter-Änderungen
      \item einfach domänenspezif. Strukturen zum Suchraum hinzuzufügen
      \item \texttt{Boolean, Switch} und \texttt{Enum} bewusst als komplex. Parameter, Darstellung
      als ungeordnete Sammlung $\rightarrow$ es existiert kein Gradient (wie bei prim. Parm.)
      \item \texttt{Permutation} : Liste von Werte inkl. Manipulatoren zur randomisierten Änderung der Reihenfolge
      \item \texttt{Schedule} ist Sonderfall von \texttt{Permutation} : topolog. Sortierung nach jeder Änderung
      \item \texttt{Selector}
    \end{itemize}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
  \textbf{Parameter-Interaktion}
    \begin{itemize}
      \item Zusätzlich existieren erweiterbare Methoden für die Suchtechniken um zwischen mehreren Parametern 
    zu interagieren. (z.B. Differenz-Funktion)
    \end{itemize}
    
    \textbf{\\}
  
  \textbf{Optimierungsziele}
    \begin{itemize}
      \item OpenTuner unterstützt mehrere Ziele, standardmäßig wird nach der \texttt{Zeit} optimiert
      \item \texttt{Genauigkeit, Energie, Größe} oder ein nutzerdef. Ziel
      \item Es können auch mehrere Ziele zugleich verfolgt werden, bspw. \texttt{Genauigkeit einhalten, gleichzeitig
      Zeit minimieren}
    \end{itemize}
  \end{frame}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \section{Konkrete Anwendungen der Entwickler}
    
    \begin{frame}
    \textbf{3. Existierende Anwendungen der Entwickler} \newline
      
    \textbf{a) GCC/G++ Flags}
      \begin{itemize}
        \item klassische Parameter-Optimierung
        \item unterstützte Flags: \texttt{g++ --help=optimizers}
        \item Parameter inkl. zulässiger Wertebereiche: \texttt{params.def} (gcc source code)
        \item Implementierung des Autotuners:
        \begin{itemize}
          \item 1. Erstellen des \texttt{configuration manipulator} : Menge der Parameter (Suchraum) \newline
          \emph{Optimierungslevel, GXX-Flags/-Parameter}
          \item 2. Erstellen der \texttt{run}-Funktion
          \item 3. Festlegen des Optimierungsziels
        \end{itemize}
      \end{itemize}
    \end{frame}
        
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
    \begin{figure}[ht]
      \centering	      
      \includegraphics[width=\textwidth]{bilder/ot-3-1a}
      \label{gccpy1a}
    \end{figure}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  \begin{frame}
    \begin{figure}[ht]
      \centering	      
      \includegraphics[width=\textwidth]{bilder/ot-3-1}
      \label{gccpy1}
    \end{figure}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  \begin{frame}
    \begin{figure}[ht]
      \centering	      
      \includegraphics[scale=0.9]{bilder/ot-3-2}
      \label{gccpy2}
    \end{figure}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
 \begin{frame}
   \begin{itemize}
     \item die Methode \texttt{run} implementiert die Messfunktion der Konfigurationen
     \item Konfiguration: spez. GXX-Befehlszeile (Opt, Flags, Params)
     \item Ausführen der Befehlszeile $\rightarrow$ Executable erstellen
     \item \texttt{call\_program} : Ausführen und Messen des Programms
     \item \texttt{Ergebnis} wird erstellt und in Datenbank geschrieben 
     (record type abhängig von Optimierungsziel) \newline
     \item vergleichbare Anwendung: Halide, PetaBricks, Stencil
   \end{itemize}
 \end{frame}
 
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
      \begin{figure}[ht]
      \centering	      
      \includegraphics[width=\textwidth]{bilder/outfile_8.pdf}
      \label{gccResults}
    \end{figure}
  \end{frame}    
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  \begin{frame}
   \textbf{b) Unitary Matrices}
   
    \begin{itemize}
      \item Synthetisierung von Matrizen in optimaler Zeit
      \item \textbf{bisher} traditioneller Autotuner zur Programmoptimierung
      \item \textbf{hier} Suche als Subroutine zur Laufzeit
      \item das Problem hat fixes Set von Operatoren (Controls), repräsentiert als Matrizen
      \item Ziel: Finden einer Sequenz von Operatoren, sodass Matrixmultiplikation die Zielmatrix ergibt
      \item Zielfunktion: Abstand (Genauigkeitswert) des Produktes der aktuellen Sequenz zum Ziel (trace fidelity)
    \end{itemize}
  \end{frame}
  
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
    \begin{figure}[ht]
      \centering	      
      \includegraphics[width=0.9\textwidth]{bilder/unitary.pdf}
      \label{gccpy1a}
    \end{figure}
\end{frame}

%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
   \textbf{c) Super Mario}
   
   \begin{itemize}
    \item Abschließen des ersten Levels durch Sequenz von Button-Eingaben 
    \item
   \end{itemize}
   
\end{frame}


  
%%%%% Section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \section{Anwendungsbeispiele}
    
%%%%% new frame %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \begin{frame}
    \begin{itemize}
      \item abc abc abc
    \end{itemize}
    \end{frame}
    
%%%%% Section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \section{Zusammenfassung}
     \begin{itemize}
      \item abc abc abc
    \end{itemize}
    
%%%%% Section %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \section{Quellen}
    
    
    
    

\end{document}
